<%  load File.expand_path('../../../controllers/ruls.rb',__FILE__)  %>
<% @ruls_item_code = Ruls.rules_parse(@file.skip_rows,"item_code")  %>
<% @ruls_price = Ruls.rules_parse(@file.skip_rows,"price")  %>
<% @ruls_available = Ruls.rules_parse(@file.skip_rows,"available")  %>
<%# puts "Item_code: " + @ruls_item_code.size.to_s  %> 
<%   %>

<%= link_to 'Back', updater_index_path, class: "btn btn-primary" %>
<hr>
<%= render 'flash'  %>
<%= render 'header'  %>
<hr>
<table  style=" border: 1px solid #ddd; position: absolute; left: 1px;">
	<tr>
	<% @cols.each do |r| %>
		<th><%= r %></th>
        <% end %>
	</tr>
	
<% @data.each do |e| %>
<%# if e.visible == "t" and e.send(@template["item_code"]).send(@ruls[0][:operator], nil)   %>
<%# if e.visible == "t" and Ruls.dunamic_rule(@ruls_item_code[0][:operator],@ruls_item_code[0][:value],e.send(@template["item_code"])) and Ruls.dunamic_rule(@ruls_price[0][:operator],@ruls_price[0][:value],e.send(@template["price"]))  %>
<% puts e.id.to_s + "----------------------------------"  %>
<% item_code_current_value = e.send(@template["item_code"]) %>
<% price_current_value = e.send(@template["price"]) %>
<% available_current_value = e.send(@template["available"]) %>
<% if e.visible == "t" and Ruls.not_false(@ruls_item_code,item_code_current_value) and Ruls.not_false(@ruls_price,price_current_value) and Ruls.not_false(@ruls_available,available_current_value)   %>
	<tr><% @cols.each do |r| %><td class="<%=r%>"><%= e.send(r).to_s[0..25] %></td><% end %></tr>
	
			<% else %>
				<tr class="skip_row"><% @cols.each do |r| %><td class="<%=r%>"><%= e.send(r).to_s[0..25] %></td><%end%></tr>
			<% end %>
<% end %>

</table>
<script>
  
$(function() {
	$(".<%= @template["item_code"] %>").css("background-color","aliceblue");
	$(".<%= @template["price"] %>").css("background-color","antiquewhite");
	$(".<%= @template["currency"] %>").css("background-color","khaki");
	$(".<%= @template["available"] %>").css("background-color","lightgreen");
	
});
</script>




